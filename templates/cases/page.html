{% extends "base.html" %}

{% block title %}{{ page.title }} | {{ config.title }}{% endblock title %}

{% block content %}
<!--
  ================================================================
  CASE STUDY DETAIL PAGE
  ================================================================
  導入事例の詳細ページ。
  クライアント情報、課題、解決策、成果、お客様の声を表示する。
-->

<article class="case-study">
  <!-- 事例ヘッダー -->
  <header class="article-header">
    <!-- ヒーロー画像 -->
    {% if page.extra.hero_image %}
    <div class="case-hero" style="margin-bottom: var(--space-6);">
      <img src="{{ get_url(path=page.extra.hero_image) }}" alt="{{ page.title }}">
    </div>
    {% endif %}

    <!-- タイトル -->
    <h1>{{ page.title }}</h1>

    <!-- クライアント情報カード -->
    {% if page.extra.client_name or page.extra.logo %}
    <div class="case-client-info">
      {% if page.extra.logo %}
      <img src="{{ get_url(path=page.extra.logo) }}" alt="{{ page.extra.client_name | default(value='Client') }}">
      {% endif %}
      <div>
        <h2 style="font-size: var(--font-size-xl); margin: 0 0 var(--space-1) 0;">{{ page.extra.client_name }} 様</h2>
        <p style="margin: 0; color: var(--color-text-light);">
          <strong>業種:</strong> {{ page.extra.industry | default(value='未設定') }}
          | <strong>規模:</strong> {{ page.extra.company_size | default(value='未設定') }}
        </p>
      </div>
    </div>
    {% endif %}
  </header>

  <!-- 事例本文 -->
  <div class="article__content">
    {{ page.content | safe }}
  </div>

  <!-- お客様の声 -->
  {% if page.extra.testimonial %}
  <section class="section fade-in" style="background: var(--color-bg-alt); padding: var(--space-8); border-radius: var(--radius-lg); border-left: 4px solid var(--color-secondary); box-shadow: var(--shadow-sm); margin-top: var(--space-8);">
    <h3 style="margin-top: 0; color: var(--color-secondary); font-size: var(--font-size-xl);">お客様の声</h3>
    <blockquote style="border-left: none; padding-left: 0; background: none; font-size: var(--font-size-lg); line-height: 1.85;">
      {{ page.extra.testimonial }}
    </blockquote>
    {% if page.extra.testimonial_author %}
    <p style="text-align: right; font-weight: 600; margin-bottom: 0; color: var(--color-text);">— {{ page.extra.testimonial_author }}</p>
    {% endif %}
  </section>
  {% endif %}

  <!-- 関連事例 -->
  {% if section %}
  <section class="section fade-in">
    <div class="section__inner">
      <header class="section__header">
        <h2>関連事例</h2>
      </header>
      <div class="content-list" role="list">
        {% for related in section.pages | slice(end=3) %}
        {% if related.permalink != page.permalink %}
        <article class="content-card" role="listitem">
          {% if related.extra.logo %}
          <img src="{{ get_url(path=related.extra.logo) }}" alt="{{ related.extra.client_name }}" class="content-card__image">
          {% endif %}
          <div class="content-card__content">
            <h2 class="content-card__title">
              <a href="{{ related.permalink }}">{{ related.title }}</a>
            </h2>
            <div class="content-card__meta">
              {% if related.extra.industry %}
              <span class="content-card__category">{{ related.extra.industry }}</span>
              {% endif %}
            </div>
            {% if related.description %}
            <p class="content-card__description">{{ related.description }}</p>
            {% endif %}
          </div>
        </article>
        {% endif %}
        {% endfor %}
      </div>
    </div>
  </section>
  {% endif %}
</article>
{% endblock content %}
